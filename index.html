<!DOCTYPE html>

<html>
<head>
  <title>Raytracing</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="custom.css" />
  <script src="jquery.min.js"></script>
  <script src="circle-progress.js"></script>
</head>
<body>
   <div class="circles">
    <div class="first circle"><strong></strong></div>
  </div>
  <div id="container">
    <div class='cred'>
        <a href='https://github.com/tmcw/literate-raytracer'>an open source project by tom macwright</a>
    </div>
    <canvas id='c'></canvas>
    <center>
        <button id='play'>play</button>
        <button id='stop'>stop</button>
    </center>
	    </div>
  <script src='vector.js'></script>
  <script src='index.js'></script>
 <script src='dat.gui.min.js'></script>
  <script type="text/javascript">


 var objet = function() {
   this.posXcam= scene.camera.point.x,
   this.posYcam= scene.camera.point.y,
   this.posZcam= scene.camera.point.z,
   this.posXlook= scene.camera.vector.x,
   this.posYlook= scene.camera.vector.y,
   this.posZlook= scene.camera.vector.z,

   this.posXlum= scene.lights[0].x,
   this.posYlum= scene.lights[0].y,
   this.posZlum= scene.lights[0].z,
   
   this.colorCercle1 = [ scene.objects[0].color.x, scene.objects[0].color.y, scene.objects[0].color.z ],
   this.specularCercle1 = scene.objects[0].specular,  
   this.lambertCercle1 = scene.objects[0].lambert,  
   this.ambientCercle1 = scene.objects[0].ambient,  
   this.radiusCercle1 = scene.objects[0].radius     

   };
      
   var obj = new objet();
   var gui = new dat.GUI({  load: JSON });
   gui.remember(obj);

   var maj  = function(value) { 
   scene.camera.point.x = obj.posXcam;
   scene.camera.point.y = obj.posYcam;
   scene.camera.point.z = obj.posZcam;
   scene.camera.vector.x = obj.posXlook;
   scene.camera.vector.y = obj.posYlook;
   scene.camera.vector.z = obj.posZlook;

   scene.lights[0].x =  obj.posXlum;
   scene.lights[0].y =  obj.posYlum;
   scene.lights[0].z =  obj.posZlum;

   scene.objects[0].color.x = obj.colorCercle1[0];
   scene.objects[0].color.y = obj.colorCercle1[1];
   scene.objects[0].color.z = obj.colorCercle1[2];
   scene.objects[0].specular = obj.specularCercle1;  
   scene.objects[0].lambert = obj.lambertCercle1;  
   scene.objects[0].ambient = obj.ambientCercle1;  
   scene.objects[0].radius = obj.radiusCercle1; 
   }

   var maj2  = function(value) {  
   
      var time =  new Date().getTime(); 
	  render(scene);
	      var now = new Date().getTime(),
    dt = now - time; 
	  $('.first.circle').circleProgress({
     value: dt/1000,
  fill: {gradient: ['#78fa70', '#ff5f43']}
}).on('circle-animation-progress', function(event, progress, stepValue) {
  $(this).find('strong').text(String(stepValue.toFixed(2)).substr(0));
}) 
   
   }
   
   f = gui.addFolder('Mouvement');
   f.add(obj, "posXcam").min(-100).max(100).onChange(maj).onFinishChange(maj2);   
   f.add(obj, "posYcam").min(-100).max(100).onChange(maj).onFinishChange(maj2);
   f.add(obj, "posZcam").min(-100).max(100).onChange(maj).onFinishChange(maj2);
   f.add(obj, "posXlook").min(-100).max(100).onChange(maj).onFinishChange(maj2);
   f.add(obj, "posYlook").min(-100).max(100).onChange(maj).onFinishChange(maj2);
   f.add(obj, "posZlook").min(-100).max(100).onChange(maj).onFinishChange(maj2);
   f.close();
   f = gui.addFolder('lumiere position');
   f.add(obj, "posXlum").min(-255).max(255).onChange(maj).onFinishChange(maj2);
   f.add(obj, "posYlum").min(-255).max(255).onChange(maj).onFinishChange(maj2);
   f.add(obj, "posZlum").min(-255).max(255).onChange(maj).onFinishChange(maj2);
   f.close();
   f = gui.addFolder('sphere1');
   f.addColor(obj,"colorCercle1").onChange(maj).onFinishChange(maj2);
   f.add(obj, "specularCercle1").min(0).max(2).onChange(maj).onFinishChange(maj2);
   f.add(obj, "lambertCercle1").min(0).max(2).onChange(maj).onFinishChange(maj2);
   f.add(obj, "ambientCercle1").min(0).max(2).onChange(maj).onFinishChange(maj2);
   f.add(obj, "radiusCercle1").min(0).max(500).onChange(maj).onFinishChange(maj2);
   f.close();
$('.first.circle').circleProgress({
  value: 0,
  fill: {gradient: [['#0681c4', .5], ['#4ac5f8', .5]], gradientAngle: Math.PI / 4}
}).on('circle-animation-progress', function(event, progress, stepValue) {
  $(this).find('strong').text(String(stepValue.toFixed(2)).substr(1));
});

</script>
</body>
</html>
